{% extends 'base.html' %}



{% block title %} Homepage {% endblock %}







{% block content %}
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

    <div class="authentication-inner py-5" style="margin: auto; width: 30%">

        <!-- Logo -->
        <div class="d-flex justify-content-center align-items-center mb-5">
            <div class="ui-w-60">
                <div class="w-100 position-relative" style="padding-bottom: 54%">
                    <svg class="w-100 h-100 position-absolute" viewBox="0 0 148 80" xmlns="http://www.w3.org/2000/svg"
                         xmlns:xlink="http://www.w3.org/1999/xlink">
                        <defs>
                            <linearGradient id="a" x1="46.49" x2="62.46" y1="53.39" y2="48.2"
                                            gradientUnits="userSpaceOnUse">
                                <stop stop-opacity=".25" offset="0"></stop>
                                <stop stop-opacity=".1" offset=".3"></stop>
                                <stop stop-opacity="0" offset=".9"></stop>
                            </linearGradient>
                            <linearGradient id="e" x1="76.9" x2="92.64" y1="26.38" y2="31.49"
                                            xlink:href="#a"></linearGradient>
                            <linearGradient id="d" x1="107.12" x2="122.74" y1="53.41" y2="48.33"
                                            xlink:href="#a"></linearGradient>
                        </defs>
                        <path class="fill-primary" transform="translate(-.1)"
                              d="M121.36,0,104.42,45.08,88.71,3.28A5.09,5.09,0,0,0,83.93,0H64.27A5.09,5.09,0,0,0,59.5,3.28L43.79,45.08,26.85,0H.1L29.43,76.74A5.09,5.09,0,0,0,34.19,80H53.39a5.09,5.09,0,0,0,4.77-3.26L74.1,35l16,41.74A5.09,5.09,0,0,0,94.82,80h18.95a5.09,5.09,0,0,0,4.76-3.24L148.1,0Z"></path>
                        <path transform="translate(-.1)"
                              d="M52.19,22.73l-8.4,22.35L56.51,78.94a5,5,0,0,0,1.64-2.19l7.34-19.2Z"
                              fill="url(#a)"></path>
                        <path transform="translate(-.1)" d="M95.73,22l-7-18.69a5,5,0,0,0-1.64-2.21L74.1,35l8.33,21.79Z"
                              fill="url(#e)"></path>
                        <path transform="translate(-.1)"
                              d="M112.73,23l-8.31,22.12,12.66,33.7a5,5,0,0,0,1.45-2l7.3-18.93Z"
                              fill="url(#d)"></path>
                    </svg>
                </div>
            </div>
        </div>
        <!-- / Logo -->

        <div class="card">
            <div class="row no-gutters row-bordered">

                <!-- Login -->
{#                <div class="col-md-2"></div>#}
                <div class="col-md-12">
                    <h5 class="text-center text-muted font-weight-normal py-4 px-4 px-sm-5 m-0">Login to Your
                        Account</h5>
                    <hr class="border-light m-0">

                    <div class="px-4 px-sm-5 pt-4 pb-5 pb-sm-5">

                        <!-- Login form -->
                        {#                        <form method="POST"> {% csrf_token %}#}
                        <div class="form-group">
                            <label class="form-label">Name</label>
                            <input type="text" name="username_l" id="username_l_ajax" class="form-control">
                        </div>
                        <div class="form-group">
                            <label class="form-label d-flex justify-content-between align-items-end">
                                <div>Password</div>
                                <a href="javascript:void(0)" class="d-block small">Forgot password?</a>
                            </label>
                            <input type="password" name="password_l" id="password_l_ajax" class="form-control">
                        </div>
                        <div class="d-flex justify-content-between align-items-center m-0">
                            <button id="login_but" class="btn btn-primary btn-block mt-4">Login
                            </button>
                        </div>
                        {#                        </form>#}
                        <!-- / Login form -->

                    </div>
                </div>
{#                <div class="col-md-2"></div>#}
                <!-- / Login -->


            </div>
        </div>

    </div>

    {% csrf_token %}
{% endblock %}

{% block javascript %}

    <script>
        var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();

        function csrfSafeMethod(method) {
            // these HTTP methods do not require CSRF protection
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }

        $.ajaxSetup({
            beforeSend: function (xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });


        $("#login_but").click(function () {

            var username = $("#username_l_ajax").val();
            var password = $("#password_l_ajax").val();

            $.ajax({
                url: '/users/ajax/login_api',
                type: "POST",
                data: {
                    'username': username,
                    'password': password
                },

                dataType: 'json',
                success: function (data) {
                    if (data.errore === 0) {
                        window.location.replace("")
                    } else if (data.errore === 1) {
                        alert("Bad request");
                    } else if (data.errore === 2) {
                        alert("Username o password non validi")
                    }
                }


            })


        })
    </script>


{% endblock %}